<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <!-- For Mobile Devices -->
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
        <meta name="generator" content="Doxygen 1.8.11"/>
        <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
        <title>Forwarder XT28 API Documentation: Excipad example</title>
        <!--<link href="tabs.css" rel="stylesheet" type="text/css"/>-->
        <script type="text/javascript" src="dynsections.js"></script>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="doxy-boot.js"></script>
        <link href="doxygen.css" rel="stylesheet" type="text/css" />
        <link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
    </head>
    <body>
        <nav class="navbar navbar-default" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand">Forwarder XT28 API Documentation 0.1.0</a>
                </div>
            </div>
        </nav>
        <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
            <div class="content" id="content">
                <div class="container">
                    <div class="row">
                        <div class="col-sm-12 panel panel-default" style="padding-bottom: 15px;">
                            <div style="margin-bottom: 15px;">
<!-- end header part --><!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Guides&#160;and&#160;Exampels</span></a></li>
      <li><a href="modules.html"><span>XT28&#160;api&#160;Documentation</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Excipad example </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>An example on how to use the exipad to setup let the user configure the machine</p>
<h1>XT28 App </h1>
<p>Using the powerfull XT28 API its possibole to create a buieterful application for the machine.</p>
<p>A exemple of the power that comes with this API is as foll0ws:</p>
<h2>Setup is so easy </h2>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> sys_main(<span class="keywordtype">void</span>) {</div><div class="line"></div><div class="line">    <span class="comment">// CAN channels configuration</span></div><div class="line">    <a class="code" href="group___x_t28_c_a_n.html#ga59733424382c71f692132e3926b59920">CANConfigureXT28CANChannels</a>();</div><div class="line"></div><div class="line">    <span class="keywordtype">int</span> databoxNrGyro = 1;</div><div class="line">    <span class="keywordtype">int</span> databoxNrAcc = 2;</div><div class="line">    <a class="code" href="group___i_m_u.html#ga90fd261348c3db31e697c037599c3b02">IMUConfigureInertialMeasurementUnit</a>(CAN_2,</div><div class="line">            databoxNrGyro,</div><div class="line">            databoxNrAcc</div><div class="line">    );</div><div class="line"></div><div class="line">    <span class="keywordtype">int</span> databoxNrExipadButtons = 3;</div><div class="line">    <span class="keywordtype">int</span> databoxNrExipadJoystrick = 4;</div><div class="line">    <a class="code" href="group___e_x_p.html#gaf3f64d7a1bfbd8810a8c8add63ab6447">EXPConfigureExcipad</a>(CAN_1,</div><div class="line">            databoxNrExipadButtons,</div><div class="line">            databoxNrExipadJoystrick</div><div class="line">    );</div><div class="line">    <a class="code" href="group___a_d_c_f_g.html#ga61892ddb86cfd859a508e15c6d376254">ADCFGConfigureParameterSettingsFromCAN</a>(CAN_1,</div><div class="line">            3,</div><div class="line">            4,</div><div class="line">            7</div><div class="line">    );</div><div class="line"></div><div class="line">    can_init(CAN_1, 1000000);</div><div class="line">    can_init(CAN_2, 500000);</div><div class="line">    can_init(CAN_3, 250000);</div><div class="line"></div><div class="line">    <a class="code" href="group___i_m_u.html#gac4416b9c9a29aa088584531470775a4f">IMUInit</a>();</div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">// Initialize RC/SRC.</span></div><div class="line">    sys_init(<span class="stringliteral">&quot;SMS&quot;</span>, <span class="stringliteral">&quot;RC30-00D6&quot;</span>); <span class="comment">// RC28-14/30</span></div><div class="line">    emcy_disableInput(EMCY_DISABLE_KEY_DU32, ~EMCY_DISABLE_KEY_DU32);</div><div class="line"></div><div class="line">    <span class="comment">// Configure analoge sensors &amp; Outputs</span></div><div class="line">    <a class="code" href="group___p_a_p_r.html#ga73f71dc01b5e585739f3d8c35f72aa60">PAPRConfigurePressureSensorsVoltageInput</a>();</div><div class="line">    <a class="code" href="group___p_a_p_o_s.html#ga548549d81fdaa14de068f81949321038">PAPOSConfigurePositionSensorsVoltageInput</a>();</div><div class="line">    <a class="code" href="group___p_a_a.html#ga978ed70157b09bfb1c105dac0d81b30a">PAAConfigurePendelumArmOutputs</a>();</div><div class="line">}</div></div><!-- fragment --><h2>Example runtime task </h2>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> sys_main(<span class="keywordtype">void</span>) {</div><div class="line">    ...</div><div class="line">    sys_registerTask( readSensorsTask_10ms,</div><div class="line">            READ_SENSORS_PRIO,</div><div class="line">            READ_SENSORS_TASK_TIME_MS,</div><div class="line">            READ_SENSORS_OFFSET_MS,</div><div class="line">            0</div><div class="line">    );</div><div class="line">    ...</div><div class="line">}</div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> readSensorsTask_10ms(<span class="keywordtype">void</span>) {</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">    <span class="comment">// Uppdate presure and recalculate force data</span></div><div class="line">    <a class="code" href="group___p_a_p_o_s.html#gab6c3a5473a3de9960604f26c3f69c0cd">PAPOSUppdatePosSensorsDataWithSampleTime</a>(READ_SENSORS_TASK_TIME_MS);</div><div class="line">    <a class="code" href="group___p_a_p_r.html#ga07cf21bb533d8cac21588c6ab12ba04c">PAPRUppdatePressureDataWithSampleTime</a>(READ_SENSORS_TASK_TIME_MS);</div><div class="line"></div><div class="line">    <span class="comment">// Get new valus for force calculations and uppdate force data </span></div><div class="line">    <span class="keywordtype">int</span> pressureData_Bar[SUM_CHAMBERS] = {0};</div><div class="line">    <span class="keywordtype">int</span> posData_mm[SUM_WHEELS] = {0};</div><div class="line">    <a class="code" href="group___p_a_p_r.html#ga9a254be842217d990516a0f3c744a096">PAPRGetPressureDataArray_bar</a>(pressureData_Bar);</div><div class="line">    <a class="code" href="group___p_a_p_o_s.html#gacda5643c2570631bdc01c87ee59becb3">PAPOSGetPosDataArray</a>(posData_mm);</div><div class="line">    <a class="code" href="group___p_a_f.html#ga6681eaa2c4a2dc2bd390dea7be84fd3a">PAFUppdateForceOnWheelsDataUsing</a>(pressureData_Bar, posData_mm);</div><div class="line"></div><div class="line">    <span class="comment">// Check the machine state and actuate accordingly </span></div><div class="line">    checkMachineStateAndActuate();</div><div class="line"></div><div class="line">    <span class="comment">// Send all the sensor data on CAN </span></div><div class="line">    sendSensorDataOnCAN();</div><div class="line">}</div></div><!-- fragment --><h2>The machines interface with the user is the excipad. </h2>
<div class="fragment"><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> checkMachineStateAndActuate(<span class="keywordtype">void</span>) {</div><div class="line"></div><div class="line">    <a class="code" href="group___e_x_p.html#ga5b6a93c1c9f55cfb4e0ce4b3bcdd8b37">exipadButton</a> machineState = <a class="code" href="group___e_x_p.html#gabb9ce75113a4b687e0954d8dbf0aeef4">EXPGetLastPressedButtonWithToggle</a>();</div><div class="line">    <span class="keywordflow">switch</span> (machineState) {</div><div class="line">        ...</div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="group___e_x_p.html#gga5b6a93c1c9f55cfb4e0ce4b3bcdd8b37a99e905f2b95d0eb72f968e81243c4c28">BUTTON_3</a>: <span class="comment">// Front Left </span></div><div class="line">        joystickControl(OFF, ON, OFF, OFF, OFF, OFF);</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line">        ...</div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="group___e_x_p.html#gga5b6a93c1c9f55cfb4e0ce4b3bcdd8b37a7f40528cf2b1308fa831c85cb29437af">BUTTON_18</a>: <span class="comment">// ADC Control </span></div><div class="line">        activeDampeningControl();</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="group___e_x_p.html#gga5b6a93c1c9f55cfb4e0ce4b3bcdd8b37ab245446c45d5cf6f8401cf072f1d05b2">BUTTON_19</a>: <span class="comment">// All Upp </span></div><div class="line">        buttonHoldControl(UPP, UPP, UPP, UPP, UPP, UPP);</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line">        ...</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --> </div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
</div>
</div>
</div>
</div>
</div>
<div class="container col-sm-12">
            <!--eri-no-index-->
<div class="treebackleftcontainer hidden-print">
    <div class="treebackrel">
        <div class="treebottomback left">
        </div>
    </div>
</div>
<div class="treebackrightcontainer hidden-print">
    <div class="treebackrel">
        <div class="treebottomback right flip">
        </div>
    </div>
</div>
<!--/eri-no-index-->
        </div>
<br>
<br>
<br>
<br>
<footer class="hidden-print">
    <div class="container">
        <div class="row" style="">
                <div class="col-sm-4 col-xxs-6">
                    <h2 class="alt">Navigation</h2>
<ul>
     	<li>
            <a href="./index.html">Main Page </a> 
        </li>
        <li>
            <a href="./modules.html">Moduels </a> 
        </li>
        <li>
            <a href="./ADCONFIG.html">Configurations </a> 
        </li>
        <li>
            <a href="./ADCONTROLLERS.html">Controllers </a> 
        </li>
</ul>
                </div>
                <div id="external" class="col-sm-4 col-xxs-6">
                    <h2 class="alt">Buddy pages</h2>
<ul>
        <li>
            <a href="http://www.skogforsk.se/" target="_blank" title="Skogforsk">Skogforsk</a> 
        </li>
         <li>
            <a href="http://www.keyo.se/" target="_blank" title="Keyo Systems AB">Keyo Systems AB</a> 
        </li>
        <li>
            <a href="http://www.kth.se/" target="_blank" title="Royal institute of tech">Royal institute of tech</a> 
        </li>
</ul>
                </div>
                <div class="col-sm-4 col-xxs-6">
                    <h2 class="alt">Contact</h2>
                    <div><i class="sf-phone"></i>&nbsp;&nbsp;073 44 03 492</div>
                    <a href="mailto: johanhm@kth.se"><i class="sf-email-unfilled"></i>&nbsp;&nbsp;johanhm@kth.se</a>
                    <br>
                </div>
        </div>
    </div>
</footer>
</body>
</html>