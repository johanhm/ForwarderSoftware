<!-- HTML header for doxygen 1.8.8-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <!-- For Mobile Devices -->
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
        <meta name="generator" content="Doxygen 1.8.11"/>
        <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
        <title>Forwarder XT28 API Documentation: Excipad example</title>
        <!--<link href="tabs.css" rel="stylesheet" type="text/css"/>-->
        <script type="text/javascript" src="dynsections.js"></script>
        <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/css/bootstrap.min.css">
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.1/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="doxy-boot.js"></script>
        <link href="doxygen.css" rel="stylesheet" type="text/css" />
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
        <link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
    </head>
    <body>
        <nav class="navbar navbar-default" role="navigation">
            <div class="container">
                <div class="navbar-header">
                    <a class="navbar-brand">Forwarder XT28 API Documentation 0.1.0</a>
                </div>
            </div>
        </nav>
        <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
            <div class="content" id="content">
                <div class="container">
                    <div class="row">
                        <div class="col-sm-12 panel panel-default" style="padding-bottom: 15px;">
                            <div style="margin-bottom: 15px;">
<!-- end header part --><!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Guides&#160;and&#160;Exampels</span></a></li>
      <li><a href="modules.html"><span>XT28&#160;API&#160;documentation</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Excipad example </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>An example on how to control the machine when using joy strick and Exciapd.</p>
<p>The excipad module gives the used functionality to comminicate with the excipad easy. This sections covers a small guide for setting upp the excipad and an example of how to use the api to change how the machine is controlled.</p>
<h2>Setup is painless </h2>
<p>Example code of setting up the Excipad comminucations. </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> sys_main(<span class="keywordtype">void</span>) {</div><div class="line"></div><div class="line">    <span class="comment">// CAN channels configuration</span></div><div class="line">    <a class="code" href="group___x_t28_c_a_n.html#ga59733424382c71f692132e3926b59920">CANConfigureXT28CANChannels</a>();</div><div class="line"></div><div class="line">    <span class="keywordtype">int</span> databoxNrExipadButtons = 3;</div><div class="line">    <span class="keywordtype">int</span> databoxNrExipadJoystrick = 4;</div><div class="line">    <a class="code" href="group___e_x_p_l_e_f_t.html#ga28feb7b0289b8692b530a2288d694cc6">EXPConfigureExcipad</a>(CAN_1,</div><div class="line">            databoxNrExipadButtons,</div><div class="line">            databoxNrExipadJoystrick</div><div class="line">    );</div><div class="line"></div><div class="line">    can_init(CAN_1, 1000000);</div><div class="line">    sys_init(<span class="stringliteral">&quot;SMS&quot;</span>, <span class="stringliteral">&quot;RC30-00D6&quot;</span>); <span class="comment">// RC28-14/30</span></div><div class="line">}</div></div><!-- fragment --><p>What we do here is the following:</p>
<ul>
<li>First to set up the CAN channels using a function defined in <a class="el" href="group___x_t28_c_a_n.html">CAN</a>.</li>
</ul>
<p>This function register that databoxes exists witch is a pre-requisite in order to be able to call the next function.</p>
<ul>
<li>Then we define what databox the excipad should use.</li>
</ul>
<p>A databox is just an abitary number that have to be unique for that specific can channel you register the excipad on. A databox register callback functions that handels the incomming message, the  handels everything else sutch as setting upp callbacks and handeling incomming messages.</p>
<ul>
<li>System init to get the system going.</li>
</ul>
<p>With the exipad setup it will now communicate with the Bodas controller. The Exipad comes packed with different functionalitys when it comes to checking what button the user have pressed. For all functionalitys check out EXP.</p>
<p>Here is an example of a function where depeing on last pressed button with toggle a machine state is set.</p>
<h2>Check machine state made easy! </h2>
<div class="fragment"><div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> checkMachineStateAndActuate(<span class="keywordtype">void</span>) {</div><div class="line"></div><div class="line">    <a class="code" href="group___e_x_p_l_e_f_t.html#ga5b6a93c1c9f55cfb4e0ce4b3bcdd8b37">exipadButton</a> machineState = <a class="code" href="group___e_x_p_l_e_f_t.html#gabb9ce75113a4b687e0954d8dbf0aeef4">EXPGetLastPressedButtonWithToggle</a>();</div><div class="line">    <span class="keywordflow">switch</span> (machineState) {</div><div class="line">        ...</div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="group___e_x_p_r_i_g_h_t.html#gga5b6a93c1c9f55cfb4e0ce4b3bcdd8b37a99e905f2b95d0eb72f968e81243c4c28">BUTTON_3</a>:</div><div class="line">        <a class="code" href="group___p_a_a.html#ga0a537d8fca7250cc663f5fc2fc5a1c5d">PAASetReferenceForWheelWithUnit</a>(FR, <a class="code" href="group___p_a_a.html#gga15da6807954393e1942ff382b518cc46a9fcb1c26ff07c0422931d11a5386e934">CURRENT_MA</a>, 100);</div><div class="line">        <a class="code" href="group___p_a_a.html#gae685f50177dba1ae770661eb69bf96cb">PAAActuatePendelumArms</a>();</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line">        ...</div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="group___e_x_p_r_i_g_h_t.html#gga5b6a93c1c9f55cfb4e0ce4b3bcdd8b37a7f40528cf2b1308fa831c85cb29437af">BUTTON_18</a>: <span class="comment">// ADC Control </span></div><div class="line">        activeDampeningControl();</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line">    <span class="keywordflow">case</span> <a class="code" href="group___e_x_p_r_i_g_h_t.html#gga5b6a93c1c9f55cfb4e0ce4b3bcdd8b37ab245446c45d5cf6f8401cf072f1d05b2">BUTTON_19</a>: <span class="comment">// All Upp </span></div><div class="line">        buttonHoldControl(UPP, UPP, UPP, UPP, UPP, UPP);</div><div class="line">        <span class="keywordflow">break</span>;</div><div class="line">        ...</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><p>What we do here is to ask the EXP what button the user pressed last. With toggle means that if the user pressed a button once it is activated and '<a class="el" href="group___e_x_p_l_e_f_t.html#gabb9ce75113a4b687e0954d8dbf0aeef4">EXPGetLastPressedButtonWithToggle()</a>' will return that button. If the user pressed that button again then '<a class="el" href="group___e_x_p_l_e_f_t.html#gabb9ce75113a4b687e0954d8dbf0aeef4">EXPGetLastPressedButtonWithToggle()</a>' will return 'NONE'. In this example, if the user have pressed button 3 then the reference current for the front left wheel will be set to 100 mA and then actuated making the wheel go down. Button 18 will do whatever is defined in 'activeDampeningControl();' and 'buttonHoldControl(...);' will probably make the machine go down. To be able to actuate and moce the pendelurm arms the <a class="el" href="group___p_a_a.html">Pendulum Arm</a> is used.</p>
<p>For more information about the power and flexibility that comes with the excipad check out EXP. </p>
</div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.8-->
<!-- start footer part -->
</div>
</div>
</div>
</div>
</div>
<div class="container col-sm-12">
            <!--eri-no-index-->
<div class="treebackleftcontainer hidden-print">
    <div class="treebackrel">
        <div class="treebottomback left">
        </div>
    </div>
</div>
<div class="treebackrightcontainer hidden-print">
    <div class="treebackrel">
        <div class="treebottomback right flip">
        </div>
    </div>
</div>
<!--/eri-no-index-->
        </div>
<br>
<br>
<br>
<br>
<footer class="hidden-print">
    <div class="container">
        <div class="row" style="">
                <div class="col-sm-4 col-xxs-6">
                    <h2 class="alt">Navigation</h2>
<ul class="fa-ul">
     	<li><i class="fa-li fa fa-angle-right"></i>
            <a href="./index.html">Main Page </a> 
        </li>
        <li><i class="fa-li fa fa-angle-right"></i>
            <a href="./modules.html">Moduels </a> 
        </li>
        <li><i class="fa-li fa fa-angle-right"></i>
            <a href="./ADCONFIG.html">Configurations </a> 
        </li>
        <li><i class="fa-li fa fa-angle-right"></i>
            <a href="./ADCONTROLLERS.html">Controllers </a> 
        </li>
</ul>
                </div>
                <div id="external" class="col-sm-4 col-xxs-6">
                    <h2 class="alt">Partners</h2>
<ul class="fa-ul">
        <li><i class="fa-li fa fa-tree"></i>
            <a href="http://www.skogforsk.se/" target="_blank" title="Skogforsk">Skogforsk</a> 
        </li>
         <li><i class="fa-li fa fa-child"></i>
            <a href="http://www.keyo.se/" target="_blank" title="Keyo Systems AB">Keyo Systems AB</a> 
        </li>
        <li><i class="fa-li fa fa-university"></i>
            <a href="http://www.kth.se/" target="_blank" title="royal institute of technology">Royal institute of technology</a> 
        </li>
</ul>
                </div>
                <div class="col-sm-4 col-xxs-6">
                    <h2 class="alt">Contact</h2>
                    <div><i class="fa fa-phone"></i><a href="tel:+46 73 440 34 92"> +46 73 440 34 92</a></div>
                    <a href="mailto: johanhm@kth.se"><i class="fa fa-envelope"></i>&nbsp;&nbsp;johanhm@kth.se</a>
                    <br>
                </div>
        </div>
    </div>
</footer>
</body>
</html>